# Document Template Customizer

This tool lets you produce *personalized document templates* from a larger base template repository, such as https://github.com/bflorat/architecture-document-template[this one].

While we have received good feedback on our previous document templates, a recurring criticism was that the *templates were too large*, leaving many sections unused. You can now *prepare smaller, tailored templates* filtered from a larger one.

Any template following a simple manifest is supported, not only our owns.


## Common use cases

. An expert (typically an *Enterprise Architect*) selects or writes a base template. This base template is usually organization-wide.
. Another expert (typically a *Senior Solution Architect*) creates a customized, curated template for one or several similar projects. This includes both a *filtered resulting template with explanations* and *blank documents* to be filled (can be partially pre-filled).
. The **single project architect** or skilled team member then finishes to fill the *blank document*, guided by the explanations in the customized template.

## Installation

* A running up-to-date version is available online https://document-template-customizer.florat.net/[here], nothing to install, you just need a browser with JavaScript enabled.

NOTE: This application is a static single‚Äëpage app (SPA) with no server‚Äëside processing. Loading the base template, filtering, and ZIP creation all happen in your browser. The hosting server never receives your documents. When you use an internal `base_template_url`, files are fetched directly from your local/network origin and are not uploaded to the Internet.

* You can install this tool on premise by downloading a https://github.com/bflorat/document-template-customizer/releases[release]. Just unzip it and expose it by a Web server.

* A NGINX-based Docker image is available https://hub.docker.com/repository/docker/bflorat/document-template-customizer/general[here].


## Prerequisites for a Base Template

* The template must be written in **https://docs.asciidoctor.org/asciidoc/latest/syntax-quick-reference/[Asciidoc]** 

TIP: Sections can start with either `=` (AsciiDoc-style) or `#` (Markdown-style) headings.

* A **`README.adoc`** file must be present at the root of the base template URL, providing an introduction and links to the document parts.

* A **`base-template-manifest.yaml`** file must be present at the root of the base template URL. A sample is provided below. 

## Base Template Manifest

* `language` : IETF BCP‚Äë47 language code (e.g., `en`, `fr`, `es`, `de`, `pt`, `it`) used to localize the ‚ÄúSee also‚Äù text inserted for `link_to` (default to English).

* `multi_values_labels` (optional): used to define available values for multi-values labels (like `detail_level::overview`,`detail_level::in-depth`, ...) in addition to those discovered automatically in the base model.

* `files_imported_into_blank_templates` imports static resources into the produced blank template only. Each entry uses `src_dir` and `dest_dir` (both mandatory). Use `dest_dir: .` to place files at the root of `blank-template/`.

* `files_imported_into_templates` works the same way but targets the resulting filtered templates (the `template/` folder in the generated archive). Use `dest_dir: .` for the root of `template/`.

### Sample full `base-template-manifest.yaml`

```
author: ACME
license: CC BY-SA 4.0
language: en
parts:
  - name: Application
    file: view-application.adoc
  - name: Development
    file: view-development.adoc
  - name: infrastructure
    file: view-infrastructure.adoc
multi_values_labels:
  - name: level
    available_values: [basic, intermediate, advanced]
  - name: project_size
    available_values: [small, medium, large]
files_imported_into_blank_templates:
  - src_dir: blank-templates
    dest_dir: .
    files:
      - file
      - README.adoc
  - src_dir: blank-templates/resources
    dest_dir: .
    files:
      - myimage.png
files_imported_into_templates:
  - src_dir: template-assets
    dest_dir: assets
    files:
      - css/main.css
      - images/logo.png
  - src_dir: diagrammes
    dest_dir: diagrammes
    files:
      - roles.svg
      - infrastructure.svg
```

## Sections metadata

Every section of each part file of the base template should be annotated with a metadata line directly above the section title (no blank line), using an AsciiDoc comment like:

```
//üè∑{"id":"74c82505-5f47-4342-8f1b-f6951d603062","labels":["level::basic","project_size::large","detail_level::abstract","context"],"link_to":["9352a89a-3f8b-4028-98d5-58fb970e01ef"]}
```

Metadata fields:

* `id`: Unique section identifier. Enables anchors and cross-references; must be unique across all parts.

NOTE: IDs are optional and only needed if a section will be linked to. They can be UUIDs or any other unique string without spaces. Some AsciiDoc rendering engines have issues with linking to anchors containing special characters, so we advise sticking to ASCII characters.

* `labels`: Filtering tags used to filter sections. Values are discovered from usage across parts.
** Discovered automatically from `//üè∑{...}` markers.
** Can be a simple flag (e.g., `performance`).
** Multi-valued labels use the `name::value` form (e.g., `project_size::large`, `project_size::medium`, `project_size::small`). Their finite set of available values must be defined in the manifest under `multi_values_labels[].available_values`. Only values defined in the manifest are recognized (they are not auto-discovered from sections). Their order is preserved and used for display/sorting.
* `link_to`: One or more target section ids to reference. Automatically inserts a `TIP: See also ‚Ä¶` line after the heading in both template and blank outputs. The text is localized using `language` from the manifest (e.g., fr ‚Üí `Voir aussi`). Use a single id string or an array. Cross-document `xref:` links are generated when the target id belongs to another part.

TIP: See many examples in https://github.com/bflorat/architecture-document-template[this base template].


## Matching rules

- If all or no labels are selected, the resulting template is the full base template.
- Level-1 sections (single `#` or `=`) are always kept.

TIP: Example: if the base template owns a section labeled `["foo","bar"]`, this section will be kept only if both `foo` and `bar` are kept selected.

- If a parent section doesn't match, all its subsections are dropped recursively.

- If a parent section matches, each subsection is evaluated and kept only if it matches.

- A section is dropped only if one of its labels is unselected or if its parent section is dropped. A section without any label is kept only if its parent is kept.

TIP: Example: if the base template owns a section labeled `foo` and a subsection labeled `bar` : if `foo` label is selected but not `bar`, only the parent section is kept.

## Blank template content

- The blank template preserves structure (headings, anchors, attributes) and the automatic `TIP: See also ‚Ä¶` added by `link_to`.
- Body text is omitted by default. To include pre-filled text in the blank template, wrap it in a `[PRE-FILLED]`.

Example block:

```
[PRE-FILLED]
====
This text will appear in the blank template.
You can write multiple lines here.
====
```

## Tips
* The generated zip contains a `customization-context.yaml` file with the generation date, base template URL, the disabled labels (`disabled_labels`) and dropped sections.
* A base template URL can be pre-filled using the `base_template_url` query param, example: `https://document-template-customizer.florat.net/?base_template_url=https%3A%2F%2Fraw.githubusercontent.com%2Fbflorat%2Fmodele-da%2Frefs%2Fheads%2Fmaster%2F`.


## List of available base templates

TIP: Contact us if you want to be listed here, new base templates contributions welcomed !

[cols="1,3,5,2,6l", options="header"]
|===
|Language |Title |Repository |Open directly | Template URL to use 

|English
|Architecture Document Template
|https://github.com/bflorat/architecture-document-template[Architecture Document Template]
|https://document-template-customizer.florat.net/?base_template_url=https%3A%2F%2Fraw.githubusercontent.com%2Fbflorat%2Farchitecture-document-template%2Frefs%2Fheads%2Fmaster%2F[Click here]
| https://raw.githubusercontent.com/bflorat/architecture-document-template/refs/heads/master/


|French
|Mod√®le de dossier d'Architecture
|https://github.com/bflorat/modele-da[Mod√®le de dossier d'Architecture]
|https://document-template-customizer.florat.net/?base_template_url=https%3A%2F%2Fraw.githubusercontent.com%2Fbflorat%2Fmodele-da%2Frefs%2Fheads%2Fmaster%2F[Click here]
| https://raw.githubusercontent.com/bflorat/modele-da/refs/heads/master/
|===
