# Document Template Customizer

This tool lets you produce *personalized document templates* from a larger base template repository, such as https://github.com/bflorat/architecture-document-template[this one].

While I've received good feedback on my previous document templates, a recurring criticism was that the *templates were too large*, leaving many sections unused. With DTC, you can *prepare smaller, tailored templates* filtered from a larger one.

Any template following a simple metamodel is supported, not only my own templates.

## Installation

* A running up-to-date version is available online https://document-template-customizer.florat.net/[here], nothing to install, you just need a browser with JavaScript enabled.

* You can install this tool on premise  by download a https://github.com/bflorat/document-template-customizer/releases[release]. Just unzip it in a directory exposed by a Web server.

* A NGINX-based Docker image is available https://hub.docker.com/repository/docker/bflorat/document-template-customizer/general[here].



## Common use cases

. An expert (typically an *Enterprise Architect*) selects or writes a base template. This base template is usually organization-wide.
. Another expert (typically a *Senior Solution Architect*) creates a customized, curated template for one or several similar projects. This includes both a *full template with explanations* and *blank documents* to be filled.
. The **single project architect** or skilled team member then fills the *blank documents*, guided by the explanations in the customized template.

## Prerequisites for a Base Template

* The template must be written in **(https://docs.asciidoctor.org/asciidoc/latest/syntax-quick-reference/[Asciidoc])** - sections can start with either `#` (Markdown-style) or `=` (AsciiDoc-style) headings.
* A **`README.adoc`** file must be present at the root of the base template URL, providing an introduction and links to the document parts.
* A **`base-template-manifest.yaml`** file must be present at the root of the base template URL. A sample is provided below. 
* All part files must be located in the same directory than the `README.adoc` file.

.Sample `base-template-manifest.yaml` :

```
author: ACME
license: CC BY-SA 4.0
parts:
  - name: Application
    file: view-application.adoc
  - name: Development
    file: view-development.adoc
  - name: infrastructure
    file: view-infrastructure.adoc  
```

## Sections metadata

Every section of each part file of the base template should be annotated with a metadata line directly above the section title (no blank line), using an AsciiDoc comment like:

//üè∑{"id":"74c82505-5f47-4342-8f1b-f6951d603062","labels":["level::basic","project_size::large","detail_level::abstract","context"]}

Metadata fields:

* `id`: Unique section identifier. Enables anchors and cross-references; must be unique across all parts.
* `labels`: Filtering tags used to include/exclude sections.
** Discovered automatically from `//üè∑{...}` markers.
** Can be a simple flag (e.g., `performance`).
** Multi-valued labels use the `name::value` form (e.g., `project_size::large`, `project_size::medium`, `project_size::small`). Values are discovered from usage across parts.
* `link_to`: One or more target section ids to reference. Automatically inserts a `TIP: See also ‚Ä¶` line after the heading in both template and blank outputs. Use a single id string or an array. Cross-document `xref:` links are generated when the target id belongs to another part.

Notes:

* Level-1 sections (single `#` or `=`) are always kept and should not be annotated.

TIP: See many examples in https://github.com/bflorat/architecture-document-template[this base template].

## Matching rules

- If all or no labels are selected, the resulting template is the full base template.
- Level-1 sections (single `#` or `=`) are always kept.
- Labels use AND semantics: a section is kept only if all its labels are satisfied by the selection. 

TIP: Example: if the base template owns a section labeled `["foo","bar"]`, this section will be kept only if both `foo` and `bar` are selected.

- If a parent section doesn't match, all its subsections are dropped recursively.

- If a parent section matches, each subsection is evaluated and kept only if it matches.

- A section is dropped only if one of its labels is unselected or if its parent section is dropped. A section without any label is kept only if its parent is kept.

TIP: Example: if the base template owns a section labeled `["foo"]` and a subsection labeled `["bar"]` : if `foo` label is selected but not `bar`, only the parent section is kept.

## Tips
* The generated zip contains a `customization-context.yaml` file with the generation date, base template URL, and selected labels.
